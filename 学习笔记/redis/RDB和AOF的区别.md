### RDB

RDB是将当前时间点的数据快照，保存到磁盘中实现数据持久化的机制。

两个命令：SAVE，BGSAVE。

**SAVE**会阻塞服务器进程，直到RDB文件创建完成以后为止。**BGSAVE**会开启一个子进程创建RDB文件，服务器仍然可以处理请求。

RDB定义：在指定的时间间隔内生成数据集的时间点快照 ，是给定时间点的全量数据备份。

RDB的优点：

1. RDB是一个紧凑的压缩的二进制文件。
2. RDB性能好，父进程唯一要做的就是fork一个子进程，剩下的工作都交给子进程完成，父进程无需进行IO操作。（父进程不需要和磁盘打交道）
3. RDB在恢复大数据集的时候，速度比AOF快。
4. RDB适合做数据库备份和容灾，用来恢复上一个版本的数据库状态。

RDB的缺点：

1. 如果想要保证redis的高可用，那么RDB不是一个好的选择。每次写RDB文件都要保存服务器整个的状态，所以这个过程会耗费时间，所以你可能得间隔五分钟执行一次SAVE。而在这五分钟出现得数据可能会丢失。
2. RDB是通过fork子进程来生成RDB文件的，所以在数据量较大的时候。可能会导致整个服务器停止服务.



### AOF

AOF是将redis的操作日志以增量的方式写入到AOF文件中。

AOF的优点：

1. 保证高可用性，AOF的fsync策略有每秒同步，每修改同步，和永不同步。所以最多丢失1S的数据。
2. 重写机制压缩AOF文件。

AOF的缺点：

1. 对于相同数据量的数据而言，AOF文件比RDB文件大。在恢复大数据量数据的时候（比如将服务器还原成之前版本的时候），RDB比AOF快。
2. AOF的效率往往低于RDB。因为AOF每秒同步一次，虽然保证了高可用，但是牺牲了性能。RDB没有AOF那么好的高可用性，但是效率比AOF高。