**zk是什么？**

Apache Zookeeper是Apache Hadoop的子项目发展而来，为分布式应用提供了，高效且可靠的分布式协调服务，提供了**统一命名服务**，**配置管理**，**分布式锁**等分布式的基础服务。

**zk的特点**

1.顺序一致性（同一个客户端发起的请求，最终将会严格地按照其发起的顺序被应用到Zookeeper中去）

2.原子性（要么全部节点都应用了某一个事务，要么都没有应用这个事务）

3.单一性（客户端再任意一个Zookeeper服务器中看到的应用情况都是一致的）

4.可靠性（一旦服务端成功应用了一个事务，并完成了对客户端的相应，那么该事务所引起的服务端状态变更就会被保存下来）

5.实时性（Zk仅仅保证在一段时间以后，客户端一定可以从服务器上读取到最新的数据状态）



**zk使用Leader,Follower,Observer三个角色**

Leader：选举出来的，可以处理client的写操作。

Follower和Observer都可以提供读服务，唯一的区别时Observer不参与Leader选举过程。



**zk中的节点有两类（机器节点和数据节点ZNode)**

zk将所有数据存在内存中，数据模型是一颗树，由斜杠分开，/foo/path1就是一个ZNode。

ZNode又可以分为持久节点和临时节点，持久节点是指一旦ZNode被创建，那么永远都不会被删除。临时节点，一旦客户端绘画失效，那么这个客户端创建的所有临时节点都会失效。



**ZAB协议**

Zookeeper Atomic Broadcast（Zookeeper原子消息广播协议）

ZAB协议是一种支持崩溃恢复的原子广播协议。



**ZAB协议的两种模式（崩溃恢复和消息广播）**

ZAB协议需要确保**在Leader服务器上已经提交的事务**最终被所有的服务器都提交。

ZAB协议需要确保丢弃那些只在Leader服务器被提出的事务。（Leader提出了一个Proposal之后就挂了，所以当Leader服务器恢复之后这个Proposal就得被丢弃）。